<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>训练记录明细</title>
		<meta name="renderer" content="webkit">
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
		<link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
	</head>
	<body>


		<div class="layui-fluid">
			<div class="layui-row layui-col-space15">
				<div class="layui-col-md12">
					<div class="layui-card">
						<div class="layui-card-body">

							<form class="layui-form" action="">

								<div class="layui-form-item">
									<label class="layui-form-label">眼别</label>
									<div class="layui-input-block">
										<select name="city"  lay-verify="" lay-search lay-filter="eyeType">
											<option value="">===选择眼别===</option>
											<option value="3">双眼</option>
											<option value="1">右眼</option>
											<option value="2">左眼</option>
										</select>
									</div>
								</div>

							</form>

							<table class="layui-hide" id="table-toolbar" lay-filter="table-toolbar">
								<thead>
									<tr>
										<th lay-data="{field:'trainEyeMode',align: 'center',templet : '#templetEyeMode',width:110}">训练眼别</th>
										<th lay-data="{field:'trainTime',align: 'center',sort: true,width:120}">训练日期</th>
										<th lay-data="{field:'trainStartTime',align: 'center',width:180}">训练开始时间</th>
										<th lay-data="{field:'trainEndTime',
											templet:function(d){
												var a= new Date(d.trainEndTime).getTime() - new Date(d.trainStartTime).getTime()
												var minutes =Math.floor(a/(1000*60))
												var seconds =Math.round(a%(1000*60) / 1000)
												return  minutes+'分'+seconds+'秒'
										},align: 'center',width:100}">训练时长</th>
										<th lay-data="{field:'delicacy',templet:'<div>{{d.delicacy}}cpm</div>',align: 'center',width:100}">灵敏度</th>
										<th lay-data="{field:'trainForward',align: 'center',width:120}">调节/放松(s)</th>
										<th lay-data="{field:'trainComment',align: 'center'}">备注</th>
									</tr>
								</thead>
							</table>
						</div>
						</div>
					</div>
				</div>
			</div>

		
		<!-- 格式化地址 -->
		<script type="text/html" id="templetEyeMode">
			{{# if(d.trainEyeMode == '1'){ }}
				右眼
			 {{# } else if(d.trainEyeMode == '2'){ }}
				左眼
			{{#  } else if(d.trainEyeMode == '3'){ }}
			   双眼
			 {{#  } }}
		</script>
		<!-- 格式训练时长 -->
		<script type="text/html" id="trainTimes">
			var startTime=new Date(d.trainStartTime)
			var endTime=new Date(d.trainEndTime)
			
			{{# if(d.trainEyeMode == '1'){ }}
				右眼
			 {{# } else if(d.trainEyeMode == '2'){ }}
				左眼
			{{#  } else if(d.trainEyeMode == '3'){ }}
			   双眼
			 {{#  } }}
		</script>
		
		
		<script src="../../layuiadmin/layui/layui.js"></script>
		<script type="text/javascript" src="../../layuiadmin/lib/city-picker.js"></script>
		<script>
			layui.config({
				base: '../../layuiadmin/' //静态资源所在路径
			}).extend({
				index: 'lib/index' //主入口模块
			}).use(['index', 'table', 'form', 'laydate'	,'address'], function() {
				var admin = layui.admin,
					table = layui.table,
					form = layui.form,
					$ = layui.$;
				var adminIndex = 0;
				var id = layui.lserver.getQueryVariable("id");
				table.init('table-toolbar', {
					elem: "#table-toolbar" //指定原始 table 容器的选择器或 DOM
						,
					title: "用户训练记录" //定义 table 的大标题（在文件导出等地方会用到）
						,
					limit: 20 //注意：请务必确保 limit 参数（默认：10）是与你服务端限定的数据条数一致
						,
					toolbar: "#table-toolbar-toolbar",
					url: layui.setter.url + 'user/queryTrainInfoById?id='+id+'&token='+layui.lserver.layAdminSession("layAdmin").token //异步数据接口相关参数
						,
					minWidth: 60,
					page: true
				});


				/**
				 *  选择眼别
				 * */
				form.on('select(eyeType)', function(data){
					reloadTable("table-toolbar", 1,data.value)
				});


				/**重新加载table
				 * @param {Object} id table中的ID
				 * @param {Object} data 条件数据
				 */
				function reloadTable(id, curr,eyeType) {

					if (curr == "" || curr == null) curr = 1
					table.reload(id, {
						where: {
							eyeType: eyeType
						}, //设定异步数据接口的额外参数
						page: {
							curr: curr //重新从第 1 页开始
						}
					}); //只重载数据
				}

			});
		</script>
	</body>
</html>
